(()=>{"use strict";class e{constructor(e,t,n,r){this.templateElement=document.getElementById(e),this.hostElement=document.getElementById(t);const s=document.importNode(this.templateElement.content,!0);this.element=s.firstElementChild,r&&(this.element.id=r),this.attach(n)}attach(e){this.hostElement.insertAdjacentElement(e?"afterbegin":"beforeend",this.element)}}function t(e,t,n){const r=n.value;return{configurable:!0,get(){return r.bind(this)}}}var n;!function(e){e[e.Active=0]="Active",e[e.Finished=1]="Finished"}(n||(n={}));class r{constructor(e,t,n,r,s){this.id=e,this.title=t,this.description=n,this.people=r,this.status=s}}class s extends class{constructor(){this.listners=[]}addListener(e){this.listners.push(e)}}{constructor(){super(),this.projects=[]}static getInstance(){return this.instance||(this.instance=new s),this.instance}addProject(e,t,s){const i=new r(Math.random().toString(),e,t,s,n.Active);this.projects.push(i),this.updateListeners()}moveProject(e,t){const n=this.projects.find((t=>t.id===e));n&&n.status!==t&&(n.status=t,this.updateListeners())}updateListeners(){for(const e of this.listners)e(this.projects.slice())}}const i=s.getInstance();var l=function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l};class o extends e{constructor(e,t){super("single-project",e,!1,t.id),this.project=t,this.configure(),this.renderContent()}get persons(){return 1===this.project.people?"1 Person":this.project.people+" Persons"}dragStartHandler(e){e.dataTransfer.setData("text/plain",this.project.id),e.dataTransfer.effectAllowed="move"}dragEndHandler(e){console.log("Drag End")}configure(){this.element.addEventListener("dragstart",this.dragStartHandler),this.element.addEventListener("dragend",this.dragEndHandler)}renderContent(){this.element.querySelector("h2").textContent=this.project.title,this.element.querySelector("h3").textContent=this.persons+" Assigned",this.element.querySelector("p").textContent=this.project.description}}l([t],o.prototype,"dragStartHandler",null),l([t],o.prototype,"dragEndHandler",null);var a=function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l};class c extends e{constructor(e){super("project-list","app",!1,e+"-projects"),this.type=e,this.assignedProjects=[],this.configure(),this.renderContent()}dragOverHandler(e){e.dataTransfer&&"text/plain"===e.dataTransfer.types[0]&&(e.preventDefault(),this.element.querySelector("ul").classList.add("droppable"))}dropHandler(e){const t=e.dataTransfer.getData("text/plain");i.moveProject(t,"active"===this.type?n.Active:n.Finished)}dragLeaveHandler(e){this.element.querySelector("ul").classList.remove("droppable")}configure(){this.element.addEventListener("dragover",this.dragOverHandler),this.element.addEventListener("drop",this.dropHandler),this.element.addEventListener("dragleave",this.dragLeaveHandler),i.addListener((e=>{const t=e.filter((e=>"active"===this.type?e.status===n.Active:e.status===n.Finished));this.assignedProjects=t,this.renderProjects()}))}renderContent(){const e=this.type+"-projects-list";this.element.querySelector("ul").id=e,this.element.querySelector("h2").textContent=this.type.toUpperCase()+" PROJECTS"}renderProjects(){document.getElementById(this.type+"-projects-list").innerHTML="";for(const e of this.assignedProjects)new o(this.element.querySelector("ul").id,e)}}function d(e){let t=!0;return e.required&&(t=t&&0!==e.value.toString().trim().length),null!=e.minLength&&"string"==typeof e.value&&(t=t&&e.value.trim().length>=e.minLength),null!=e.maxLength&&"string"==typeof e.value&&(t=t&&e.value.trim().length<=e.maxLength),null!=e.min&&"number"==typeof e.value&&(t=t&&e.value>=e.min),null!=e.max&&"number"==typeof e.value&&(t=t&&e.value<=e.max),t}a([t],c.prototype,"dragOverHandler",null),a([t],c.prototype,"dropHandler",null),a([t],c.prototype,"dragLeaveHandler",null);class u extends e{constructor(){super("project-input","app",!0,"user-input"),this.titleInputElement=this.element.querySelector("#title"),this.descriptionInputElement=this.element.querySelector("#description"),this.peopleInputElement=this.element.querySelector("#people"),this.configure()}configure(){this.element.addEventListener("submit",this.handleSubmit)}renderContent(){}gatherUserInputs(){const e=this.titleInputElement.value,t=this.descriptionInputElement.value,n=this.peopleInputElement.value,r={value:t,required:!0,minLength:5,maxLength:15},s={value:+n,required:!0,min:1,max:5};if(d({value:e,required:!0,minLength:5,maxLength:10})&&d(r)&&d(s))return[e,t,+n];alert("Invalid input")}clearInputs(){this.titleInputElement.value="",this.descriptionInputElement.value="",this.peopleInputElement.value=""}handleSubmit(e){e.preventDefault();const t=this.gatherUserInputs();if(Array.isArray(t)){const[e,n,r]=t;i.addProject(e,n,r),this.clearInputs()}}}(function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);i>3&&l&&Object.defineProperty(t,n,l)})([t],u.prototype,"handleSubmit",null),new u,new c("active"),new c("finished"),console.log("Hello there")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90eXBlc2NyaXB0LXByb2plY3QtbWFuYWdlci8uL3NyYy9jb21wb25lbnRzL2Jhc2UtY29tcG9uZW50LnRzIiwid2VicGFjazovL3R5cGVzY3JpcHQtcHJvamVjdC1tYW5hZ2VyLy4vc3JjL2RlY29yYXRvcnMvYXV0by1iaW5kLnRzIiwid2VicGFjazovL3R5cGVzY3JpcHQtcHJvamVjdC1tYW5hZ2VyLy4vc3JjL21vZGVscy9wcm9qZWN0LnRzIiwid2VicGFjazovL3R5cGVzY3JpcHQtcHJvamVjdC1tYW5hZ2VyLy4vc3JjL3N0YXRlL3Byb2plY3Qtc3RhdGUudHMiLCJ3ZWJwYWNrOi8vdHlwZXNjcmlwdC1wcm9qZWN0LW1hbmFnZXIvLi9zcmMvY29tcG9uZW50cy9wcm9qZWN0LWl0ZW0udHMiLCJ3ZWJwYWNrOi8vdHlwZXNjcmlwdC1wcm9qZWN0LW1hbmFnZXIvLi9zcmMvY29tcG9uZW50cy9wcm9qZWN0LWxpc3QudHMiLCJ3ZWJwYWNrOi8vdHlwZXNjcmlwdC1wcm9qZWN0LW1hbmFnZXIvLi9zcmMvdXRpbHMvdmFsaWRhdGlvbi50cyIsIndlYnBhY2s6Ly90eXBlc2NyaXB0LXByb2plY3QtbWFuYWdlci8uL3NyYy9jb21wb25lbnRzL3Byb2plY3QtaW5wdXQudHMiLCJ3ZWJwYWNrOi8vdHlwZXNjcmlwdC1wcm9qZWN0LW1hbmFnZXIvLi9zcmMvYXBwLnRzIl0sIm5hbWVzIjpbIkNvbXBvbmVudCIsInRlbXBsYXRlRWxJZCIsImhvc3RFbElkIiwiaW5zZXJ0QXRTdGFydCIsIm5ld0VsSWQiLCJ0aGlzIiwidGVtcGxhdGVFbGVtZW50IiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImhvc3RFbGVtZW50IiwiaW1wb3J0ZWROb2RlIiwiaW1wb3J0Tm9kZSIsImNvbnRlbnQiLCJlbGVtZW50IiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJpZCIsImF0dGFjaCIsImF0U3RhcnQiLCJpbnNlcnRBZGphY2VudEVsZW1lbnQiLCJhdXRvYmluZCIsIl8iLCJfMiIsImRlc2NyaXB0b3IiLCJvcmlnaW5hbE1ldGhvZCIsInZhbHVlIiwiY29uZmlndXJhYmxlIiwiYmluZCIsIlByb2plY3RTdGF0dXMiLCJQcm9qZWN0IiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsInBlb3BsZSIsInN0YXR1cyIsIlByb2plY3RTdGF0ZSIsImxpc3RuZXJzIiwibGlzdGVuZXJGbiIsInB1c2giLCJzdXBlciIsInByb2plY3RzIiwiaW5zdGFuY2UiLCJuZXdQcm9qZWN0IiwiTWF0aCIsInJhbmRvbSIsInRvU3RyaW5nIiwiQWN0aXZlIiwidXBkYXRlTGlzdGVuZXJzIiwicHJvamVjdElkIiwibmV3U3RhdHVzIiwicHJvamVjdCIsImZpbmQiLCJwcm9qIiwic2xpY2UiLCJwcm9qZWN0U3RhdGUiLCJnZXRJbnN0YW5jZSIsIlByb2plY3RJdGVtIiwiaG9zdElkIiwiY29uZmlndXJlIiwicmVuZGVyQ29udGVudCIsImV2ZW50IiwiZGF0YVRyYW5zZmVyIiwic2V0RGF0YSIsImVmZmVjdEFsbG93ZWQiLCJjb25zb2xlIiwibG9nIiwiYWRkRXZlbnRMaXN0ZW5lciIsImRyYWdTdGFydEhhbmRsZXIiLCJkcmFnRW5kSGFuZGxlciIsInF1ZXJ5U2VsZWN0b3IiLCJ0ZXh0Q29udGVudCIsInBlcnNvbnMiLCJQcm9qZWN0TGlzdCIsInR5cGUiLCJhc3NpZ25lZFByb2plY3RzIiwidHlwZXMiLCJwcmV2ZW50RGVmYXVsdCIsImNsYXNzTGlzdCIsImFkZCIsInByb2pJZCIsImdldERhdGEiLCJtb3ZlUHJvamVjdCIsIkZpbmlzaGVkIiwicmVtb3ZlIiwiZHJhZ092ZXJIYW5kbGVyIiwiZHJvcEhhbmRsZXIiLCJkcmFnTGVhdmVIYW5kbGVyIiwiYWRkTGlzdGVuZXIiLCJyZWxldmVudFByb2plY3RzIiwiZmlsdGVyIiwicmVuZGVyUHJvamVjdHMiLCJsaXN0SWQiLCJ0b1VwcGVyQ2FzZSIsImlubmVySFRNTCIsInByb2pJdGVtcyIsInZhbGlkYXRlIiwidmFsaWRhdGFibGVPYmplY3QiLCJpc1ZhbGlkIiwicmVxdWlyZWQiLCJ0cmltIiwibGVuZ3RoIiwibWluTGVuZ3RoIiwibWF4TGVuZ3RoIiwibWluIiwibWF4IiwiUHJvamVjdElucHV0IiwidGl0bGVJbnB1dEVsZW1lbnQiLCJkZXNjcmlwdGlvbklucHV0RWxlbWVudCIsInBlb3BsZUlucHV0RWxlbWVudCIsImhhbmRsZVN1Ym1pdCIsInZhbGlkYXRhYmxlRGVzY3JpcHRpb25JbnB1dCIsInZhbGlkYXRhYmxlUGVvcGxlSW5wdXQiLCJhbGVydCIsImUiLCJ1c2VySW5wdXRzIiwiZ2F0aGVyVXNlcklucHV0cyIsIkFycmF5IiwiaXNBcnJheSIsImFkZFByb2plY3QiLCJjbGVhcklucHV0cyJdLCJtYXBwaW5ncyI6Im1CQUVPLE1BQWVBLEVBS3BCLFlBQVlDLEVBQXFCQyxFQUFpQkMsRUFBd0JDLEdBRXhFQyxLQUFLQyxnQkFBa0JDLFNBQVNDLGVBQWVQLEdBQy9DSSxLQUFLSSxZQUFjRixTQUFTQyxlQUFlTixHQUMzQyxNQUFNUSxFQUFlSCxTQUFTSSxXQUFXTixLQUFLQyxnQkFBZ0JNLFNBQVMsR0FDdkVQLEtBQUtRLFFBQVVILEVBQWFJLGtCQUN4QlYsSUFDRkMsS0FBS1EsUUFBUUUsR0FBS1gsR0FFcEJDLEtBQUtXLE9BQU9iLEdBRU4sT0FBT2MsR0FDYlosS0FBS0ksWUFBWVMsc0JBQXNCRCxFQUFTLGFBQWMsWUFBY1osS0FBS1EsVUNsQjlFLFNBQVNNLEVBQVNDLEVBQU9DLEVBQVdDLEdBQ3pDLE1BQU1DLEVBQWlCRCxFQUFXRSxNQVFsQyxNQVArQyxDQUM3Q0MsY0FBYyxFQUNkLE1BRUUsT0FEZUYsRUFBZUcsS0FBS3JCLFFDTHpDLElBQVlzQixHQUFaLFNBQVlBLEdBQ1YsdUJBQ0EsMkJBRkYsQ0FBWUEsTUFBYSxLQUlsQixNQUFNQyxFQUNYLFlBQW1CYixFQUFtQmMsRUFBc0JDLEVBQTRCQyxFQUF1QkMsR0FBNUYsS0FBQWpCLEtBQW1CLEtBQUFjLFFBQXNCLEtBQUFDLGNBQTRCLEtBQUFDLFNBQXVCLEtBQUFDLFVDUzFHLE1B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aWxlIjoiYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy9Db21wb25lbnQgYmFzZSBjbGFzc1xuXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgQ29tcG9uZW50IDxUIGV4dGVuZHMgSFRNTEVsZW1lbnQsIFUgZXh0ZW5kcyBIVE1MRWxlbWVudD4ge1xuICB0ZW1wbGF0ZUVsZW1lbnQ6IEhUTUxUZW1wbGF0ZUVsZW1lbnRcbiAgaG9zdEVsZW1lbnQ6IFRcbiAgZWxlbWVudDogVVxuXG4gIGNvbnN0cnVjdG9yKHRlbXBsYXRlRWxJZDpzdHJpbmcsIGhvc3RFbElkOnN0cmluZywgaW5zZXJ0QXRTdGFydDogYm9vbGVhbiwgbmV3RWxJZD86IHN0cmluZ1xuICAgICkge1xuICAgIHRoaXMudGVtcGxhdGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGVtcGxhdGVFbElkKSEgYXMgSFRNTFRlbXBsYXRlRWxlbWVudFxuICAgIHRoaXMuaG9zdEVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChob3N0RWxJZCkhIGFzIFRcbiAgICBjb25zdCBpbXBvcnRlZE5vZGUgPSBkb2N1bWVudC5pbXBvcnROb2RlKHRoaXMudGVtcGxhdGVFbGVtZW50LmNvbnRlbnQsIHRydWUpXG4gICAgdGhpcy5lbGVtZW50ID0gaW1wb3J0ZWROb2RlLmZpcnN0RWxlbWVudENoaWxkIGFzIFVcbiAgICBpZiAobmV3RWxJZCkge1xuICAgICAgdGhpcy5lbGVtZW50LmlkID0gbmV3RWxJZFxuICAgIH1cbiAgICB0aGlzLmF0dGFjaChpbnNlcnRBdFN0YXJ0KVxuICB9XG4gIHByaXZhdGUgYXR0YWNoKGF0U3RhcnQ6IGJvb2xlYW4pIHtcbiAgICB0aGlzLmhvc3RFbGVtZW50Lmluc2VydEFkamFjZW50RWxlbWVudChhdFN0YXJ0PyAnYWZ0ZXJiZWdpbicgOidiZWZvcmVlbmQnICwgdGhpcy5lbGVtZW50KVxuICB9XG4gIGFic3RyYWN0IGNvbmZpZ3VyZSgpOiB2b2lkXG4gIGFic3RyYWN0IHJlbmRlckNvbnRlbnQoKTogdm9pZFxufSIsIi8vQXV0b2JpbmQgRGVjb3JhdG9yXG5leHBvcnQgZnVuY3Rpb24gYXV0b2JpbmQoXzphbnksIF8yOnN0cmluZywgZGVzY3JpcHRvcjogUHJvcGVydHlEZXNjcmlwdG9yKSB7XG4gIGNvbnN0IG9yaWdpbmFsTWV0aG9kID0gZGVzY3JpcHRvci52YWx1ZVxuICBjb25zdCBhZGp1c3RlZERlc2NyaXB0b3I6IFByb3BlcnR5RGVzY3JpcHRvciA9IHtcbiAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgZ2V0KCkge1xuICAgICAgY29uc3QgYmluZEZuID0gb3JpZ2luYWxNZXRob2QuYmluZCh0aGlzKVxuICAgICAgcmV0dXJuIGJpbmRGblxuICAgIH1cbiAgfVxuICByZXR1cm4gYWRqdXN0ZWREZXNjcmlwdG9yXG59IiwiLy9Qcm9qZWN0IGNsYXNzXG5leHBvcnQgZW51bSBQcm9qZWN0U3RhdHVzIHtcbiAgQWN0aXZlLFxuICBGaW5pc2hlZFxufVxuZXhwb3J0IGNsYXNzIFByb2plY3Qge1xuICBjb25zdHJ1Y3RvcihwdWJsaWMgaWQ6IHN0cmluZywgcHVibGljIHRpdGxlOiBzdHJpbmcsIHB1YmxpYyBkZXNjcmlwdGlvbjogc3RyaW5nLCBwdWJsaWMgcGVvcGxlOiBudW1iZXIsIHB1YmxpYyBzdGF0dXM6IFByb2plY3RTdGF0dXMpIHtcbiAgfVxufVxuIiwiLy9Qcm9qZWN0IHN0YXRlIG1hbmFnZW1lbnRcblxuaW1wb3J0IHsgUHJvamVjdCB9IGZyb20gXCIuLi9tb2RlbHMvcHJvamVjdFwiXG5pbXBvcnQgeyBQcm9qZWN0U3RhdHVzIH0gZnJvbSBcIi4uL21vZGVscy9wcm9qZWN0XCJcblxudHlwZSBMaXN0bmVyPFQ+ID0gKGl0ZW1zOiBUW10pID0+IHZvaWRcblxuY2xhc3MgU3RhdGU8VD4ge1xuICBwcm90ZWN0ZWQgbGlzdG5lcnM6IExpc3RuZXI8VD5bXSA9IFtdXG5cbiAgYWRkTGlzdGVuZXIobGlzdGVuZXJGbjogTGlzdG5lcjxUPikge1xuICAgIHRoaXMubGlzdG5lcnMucHVzaChsaXN0ZW5lckZuKVxuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBQcm9qZWN0U3RhdGUgZXh0ZW5kcyBTdGF0ZTxQcm9qZWN0PntcbiAgcHJpdmF0ZSBwcm9qZWN0czogUHJvamVjdFtdID0gW11cbiAgcHJpdmF0ZSBzdGF0aWMgaW5zdGFuY2U6IFByb2plY3RTdGF0ZVxuXG4gIHByaXZhdGUgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoKVxuICB9XG5cbiAgc3RhdGljIGdldEluc3RhbmNlKCkge1xuICAgIGlmICh0aGlzLmluc3RhbmNlKSB7XG4gICAgICByZXR1cm4gdGhpcy5pbnN0YW5jZVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHRoaXMuaW5zdGFuY2UgPSBuZXcgUHJvamVjdFN0YXRlKClcbiAgICAgIHJldHVybiB0aGlzLmluc3RhbmNlXG4gICAgfVxuICB9XG5cbiAgYWRkUHJvamVjdCh0aXRsZTogc3RyaW5nLCBkZXNjcmlwdGlvbjogc3RyaW5nLCBwZW9wbGU6IG51bWJlcikge1xuICAgIGNvbnN0IG5ld1Byb2plY3QgPSBuZXcgUHJvamVjdChcbiAgICAgIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoKSxcbiAgICAgIHRpdGxlLFxuICAgICAgZGVzY3JpcHRpb24sXG4gICAgICBwZW9wbGUsXG4gICAgICBQcm9qZWN0U3RhdHVzLkFjdGl2ZVxuICAgIClcbiAgICB0aGlzLnByb2plY3RzLnB1c2gobmV3UHJvamVjdClcbiAgICB0aGlzLnVwZGF0ZUxpc3RlbmVycygpXG4gIH1cblxuICBtb3ZlUHJvamVjdChwcm9qZWN0SWQ6c3RyaW5nLCBuZXdTdGF0dXM6IFByb2plY3RTdGF0dXMpIHtcbiAgICBjb25zdCBwcm9qZWN0ID0gdGhpcy5wcm9qZWN0cy5maW5kKHByb2ogPT4gcHJvai5pZCA9PT0gcHJvamVjdElkKVxuICAgIGlmIChwcm9qZWN0ICYmIHByb2plY3Quc3RhdHVzICE9PSBuZXdTdGF0dXMpIHtcbiAgICAgIHByb2plY3Quc3RhdHVzID0gbmV3U3RhdHVzXG4gICAgICB0aGlzLnVwZGF0ZUxpc3RlbmVycygpXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSB1cGRhdGVMaXN0ZW5lcnMoKSB7XG4gICAgZm9yIChjb25zdCBsaXN0ZW5lckZuIG9mIHRoaXMubGlzdG5lcnMpIHtcbiAgICAgIGxpc3RlbmVyRm4odGhpcy5wcm9qZWN0cy5zbGljZSgpKVxuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgY29uc3QgcHJvamVjdFN0YXRlID0gUHJvamVjdFN0YXRlLmdldEluc3RhbmNlKCkiLCJpbXBvcnQgeyBDb21wb25lbnQgfSBmcm9tIFwiLi9iYXNlLWNvbXBvbmVudFwiXG5pbXBvcnQgeyBhdXRvYmluZCB9IGZyb20gXCIuLi9kZWNvcmF0b3JzL2F1dG8tYmluZFwiXG5pbXBvcnQgeyBQcm9qZWN0IH0gZnJvbSBcIi4uL21vZGVscy9wcm9qZWN0XCJcbmltcG9ydCB7IERhcmdhYmxlIH0gZnJvbSBcIi4uL21vZGVscy9kcmFnLWRyb3BcIlxuXG5cbi8vIFByb2plY3QgSXRlbSBDbGFzc1xuZXhwb3J0IGNsYXNzIFByb2plY3RJdGVtIGV4dGVuZHMgQ29tcG9uZW50PEhUTUxVTGlzdEVsZW1lbnQsIEhUTUxMSUVsZW1lbnQ+IGltcGxlbWVudHMgRGFyZ2FibGV7XG4gIHByaXZhdGUgcHJvamVjdDogUHJvamVjdFxuXG4gIGdldCBwZXJzb25zKCkge1xuICAgIGlmICh0aGlzLnByb2plY3QucGVvcGxlID09PSAxKSB7XG4gICAgICByZXR1cm4gJzEgUGVyc29uJ1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHJldHVybiBgJHt0aGlzLnByb2plY3QucGVvcGxlfSBQZXJzb25zYFxuICAgIH1cbiAgfVxuXG4gIGNvbnN0cnVjdG9yKGhvc3RJZDogc3RyaW5nLCBwcm9qZWN0OiBQcm9qZWN0KSB7XG4gICAgc3VwZXIoJ3NpbmdsZS1wcm9qZWN0JywgaG9zdElkLCBmYWxzZSwgcHJvamVjdC5pZClcbiAgICB0aGlzLnByb2plY3QgPSBwcm9qZWN0IFxuICAgIHRoaXMuY29uZmlndXJlKClcbiAgICB0aGlzLnJlbmRlckNvbnRlbnQoKVxuICB9XG5cbiAgQGF1dG9iaW5kXG4gIGRyYWdTdGFydEhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCkge1xuICAgIGV2ZW50LmRhdGFUcmFuc2ZlciEuc2V0RGF0YSgndGV4dC9wbGFpbicsIHRoaXMucHJvamVjdC5pZClcbiAgICBldmVudC5kYXRhVHJhbnNmZXIhLmVmZmVjdEFsbG93ZWQgPSAnbW92ZSdcbiAgfVxuXG4gIEBhdXRvYmluZFxuICBkcmFnRW5kSGFuZGxlcihfOiBEcmFnRXZlbnQpIHtcbiAgICBjb25zb2xlLmxvZygnRHJhZyBFbmQnKVxuICB9XG5cbiAgY29uZmlndXJlKCkge1xuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnc3RhcnQnLCB0aGlzLmRyYWdTdGFydEhhbmRsZXIpXG4gICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdlbmQnLCB0aGlzLmRyYWdFbmRIYW5kbGVyKVxuICB9XG5cbiAgcmVuZGVyQ29udGVudCgpIHtcbiAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignaDInKSEudGV4dENvbnRlbnQgPSB0aGlzLnByb2plY3QudGl0bGVcbiAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignaDMnKSEudGV4dENvbnRlbnQgPSB0aGlzLnBlcnNvbnMgKyAnIEFzc2lnbmVkJ1xuICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCdwJykhLnRleHRDb250ZW50ID0gdGhpcy5wcm9qZWN0LmRlc2NyaXB0aW9uXG4gIH1cbn0iLCJpbXBvcnQgeyBDb21wb25lbnQgfSBmcm9tIFwiLi9iYXNlLWNvbXBvbmVudFwiXG5pbXBvcnQgeyBhdXRvYmluZCB9IGZyb20gXCIuLi9kZWNvcmF0b3JzL2F1dG8tYmluZFwiXG5pbXBvcnQgeyBQcm9qZWN0IH0gZnJvbSBcIi4uL21vZGVscy9wcm9qZWN0XCJcbmltcG9ydCB7IFByb2plY3RTdGF0dXMgfSBmcm9tIFwiLi4vbW9kZWxzL3Byb2plY3RcIlxuaW1wb3J0IHsgRHJhZ1RhcmdldCB9IGZyb20gXCIuLi9tb2RlbHMvZHJhZy1kcm9wXCJcbmltcG9ydCB7IHByb2plY3RTdGF0ZSB9IGZyb20gXCIuLi9zdGF0ZS9wcm9qZWN0LXN0YXRlXCJcbmltcG9ydCB7IFByb2plY3RJdGVtIH0gZnJvbSBcIi4vcHJvamVjdC1pdGVtXCJcblxuXG5cbi8vUHJvamVjdCBMaXN0IGNsYXNzXG5leHBvcnQgY2xhc3MgUHJvamVjdExpc3QgZXh0ZW5kcyBDb21wb25lbnQgPEhUTUxEaXZFbGVtZW50LCBIVE1MRWxlbWVudD4gaW1wbGVtZW50cyBEcmFnVGFyZ2V0e1xuICBcbiAgYXNzaWduZWRQcm9qZWN0czogUHJvamVjdFtdXG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSB0eXBlOiAnYWN0aXZlJyB8ICdmaW5pc2hlZCcpIHtcbiAgICBzdXBlcigncHJvamVjdC1saXN0JywgJ2FwcCcsIGZhbHNlICwgYCR7dHlwZX0tcHJvamVjdHNgIClcbiAgICB0aGlzLmFzc2lnbmVkUHJvamVjdHMgPSBbXVxuICAgIHRoaXMuY29uZmlndXJlKClcbiAgICB0aGlzLnJlbmRlckNvbnRlbnQoKVxuICB9XG5cbiAgQGF1dG9iaW5kXG4gIGRyYWdPdmVySGFuZGxlcihldmVudDogRHJhZ0V2ZW50KSB7XG4gICAgaWYgKGV2ZW50LmRhdGFUcmFuc2ZlciAmJiBldmVudC5kYXRhVHJhbnNmZXIudHlwZXNbMF0gPT09ICd0ZXh0L3BsYWluJykge1xuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKVxuICAgICAgY29uc3QgbGlzdEVsID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJykhXG4gICAgICBsaXN0RWwuY2xhc3NMaXN0LmFkZCgnZHJvcHBhYmxlJylcbiAgICB9XG4gICAgXG4gIH1cblxuICBAYXV0b2JpbmRcbiAgZHJvcEhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCkgeyBcbiAgICBjb25zdCBwcm9qSWQgPSBldmVudC5kYXRhVHJhbnNmZXIhLmdldERhdGEoJ3RleHQvcGxhaW4nKVxuICAgIHByb2plY3RTdGF0ZS5tb3ZlUHJvamVjdChwcm9qSWQsIHRoaXMudHlwZSA9PT0gJ2FjdGl2ZSc/IFByb2plY3RTdGF0dXMuQWN0aXZlIDogUHJvamVjdFN0YXR1cy5GaW5pc2hlZClcbiAgfVxuXG4gIEBhdXRvYmluZFxuICBkcmFnTGVhdmVIYW5kbGVyKF86IERyYWdFdmVudCkge1xuICAgIGNvbnN0IGxpc3RFbCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCd1bCcpIVxuICAgIGxpc3RFbC5jbGFzc0xpc3QucmVtb3ZlKCdkcm9wcGFibGUnKVxuICB9XG5cbiAgY29uZmlndXJlKCkge1xuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnb3ZlcicsIHRoaXMuZHJhZ092ZXJIYW5kbGVyKVxuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcm9wJywgdGhpcy5kcm9wSGFuZGxlcilcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2xlYXZlJywgdGhpcy5kcmFnTGVhdmVIYW5kbGVyKVxuICAgIHByb2plY3RTdGF0ZS5hZGRMaXN0ZW5lcigocHJvamVjdHM6IFByb2plY3RbXSkgPT4ge1xuICAgICAgY29uc3QgcmVsZXZlbnRQcm9qZWN0cyA9IHByb2plY3RzLmZpbHRlcihwcm9qID0+IHtcbiAgICAgICAgaWYgKHRoaXMudHlwZSA9PT0gJ2FjdGl2ZScpIHtcbiAgICAgICAgICByZXR1cm4gcHJvai5zdGF0dXMgPT09IFByb2plY3RTdGF0dXMuQWN0aXZlXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHByb2ouc3RhdHVzID09PSBQcm9qZWN0U3RhdHVzLkZpbmlzaGVkXG4gICAgICB9KVxuICAgICAgdGhpcy5hc3NpZ25lZFByb2plY3RzID0gcmVsZXZlbnRQcm9qZWN0c1xuICAgICAgdGhpcy5yZW5kZXJQcm9qZWN0cygpXG4gICAgfSlcbiAgfVxuICByZW5kZXJDb250ZW50KCkge1xuICAgIGNvbnN0IGxpc3RJZCA9IGAke3RoaXMudHlwZX0tcHJvamVjdHMtbGlzdGBcbiAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcigndWwnKSEuaWQgPSBsaXN0SWRcbiAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignaDInKSEudGV4dENvbnRlbnQgPSB0aGlzLnR5cGUudG9VcHBlckNhc2UoKSsnIFBST0pFQ1RTJ1xuICB9XG5cbiAgcHJpdmF0ZSByZW5kZXJQcm9qZWN0cygpIHtcbiAgICBjb25zdCBsaXN0RWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgJHt0aGlzLnR5cGV9LXByb2plY3RzLWxpc3RgKSEgYXMgSFRNTFVMaXN0RWxlbWVudFxuICAgIGxpc3RFbC5pbm5lckhUTUwgPSAnJ1xuICAgIGZvciAoY29uc3QgcHJvakl0ZW1zIG9mIHRoaXMuYXNzaWduZWRQcm9qZWN0cykge1xuICAgICAgbmV3IFByb2plY3RJdGVtKHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCd1bCcpIS5pZCwgcHJvakl0ZW1zKVxuICAgIH1cbiAgfVxufSIsIi8vIFZhbGlkYXRpb25cbmV4cG9ydCBpbnRlcmZhY2UgdmFsaWRhdGFibGUge1xuICB2YWx1ZTogc3RyaW5nIHwgbnVtYmVyLFxuICByZXF1aXJlZDogYm9vbGVhbixcbiAgbWluTGVuZ3RoPzogbnVtYmVyLFxuICBtYXhMZW5ndGg/OiBudW1iZXIsXG4gIG1pbj86IG51bWJlcixcbiAgbWF4PzogbnVtYmVyXG59XG5cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZSh2YWxpZGF0YWJsZU9iamVjdDogdmFsaWRhdGFibGUpICB7XG4gIGxldCBpc1ZhbGlkID0gdHJ1ZVxuICBpZiAodmFsaWRhdGFibGVPYmplY3QucmVxdWlyZWQpIHtcbiAgICBpc1ZhbGlkID0gaXNWYWxpZCAmJiB2YWxpZGF0YWJsZU9iamVjdC52YWx1ZS50b1N0cmluZygpLnRyaW0oKS5sZW5ndGggIT09IDBcbiAgfVxuICBpZiAodmFsaWRhdGFibGVPYmplY3QubWluTGVuZ3RoICE9IG51bGwgJiYgdHlwZW9mIHZhbGlkYXRhYmxlT2JqZWN0LnZhbHVlID09PSAnc3RyaW5nJykge1xuICAgIGlzVmFsaWQgPSBpc1ZhbGlkICYmIHZhbGlkYXRhYmxlT2JqZWN0LnZhbHVlLnRyaW0oKS5sZW5ndGggPj0gdmFsaWRhdGFibGVPYmplY3QubWluTGVuZ3RoXG4gIH1cbiAgaWYgKHZhbGlkYXRhYmxlT2JqZWN0Lm1heExlbmd0aCAhPSBudWxsICYmIHR5cGVvZiB2YWxpZGF0YWJsZU9iamVjdC52YWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICBpc1ZhbGlkID0gaXNWYWxpZCAmJiB2YWxpZGF0YWJsZU9iamVjdC52YWx1ZS50cmltKCkubGVuZ3RoIDw9IHZhbGlkYXRhYmxlT2JqZWN0Lm1heExlbmd0aFxuICB9XG4gIGlmICh2YWxpZGF0YWJsZU9iamVjdC5taW4gIT0gbnVsbCAmJiB0eXBlb2YgdmFsaWRhdGFibGVPYmplY3QudmFsdWUgPT09ICdudW1iZXInKSB7XG4gICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgdmFsaWRhdGFibGVPYmplY3QudmFsdWUgPj0gdmFsaWRhdGFibGVPYmplY3QubWluXG4gIH1cbiAgaWYgKHZhbGlkYXRhYmxlT2JqZWN0Lm1heCAhPSBudWxsICYmIHR5cGVvZiB2YWxpZGF0YWJsZU9iamVjdC52YWx1ZSA9PT0gJ251bWJlcicpIHtcbiAgICBpc1ZhbGlkID0gaXNWYWxpZCAmJiB2YWxpZGF0YWJsZU9iamVjdC52YWx1ZSA8PSB2YWxpZGF0YWJsZU9iamVjdC5tYXhcbiAgfVxuICByZXR1cm4gaXNWYWxpZFxufSIsImltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gXCIuL2Jhc2UtY29tcG9uZW50XCJcbmltcG9ydCAqIGFzIFZhbGlkYXRpb24gZnJvbSBcIi4uL3V0aWxzL3ZhbGlkYXRpb25cIlxuaW1wb3J0IHsgcHJvamVjdFN0YXRlIH0gZnJvbSBcIi4uL3N0YXRlL3Byb2plY3Qtc3RhdGVcIlxuaW1wb3J0IHsgYXV0b2JpbmQgfSBmcm9tIFwiLi4vZGVjb3JhdG9ycy9hdXRvLWJpbmRcIlxuXG5cbi8vUHJvamVjdCBJbnB1dCBjbGFzc1xuZXhwb3J0IGNsYXNzIFByb2plY3RJbnB1dCBleHRlbmRzIENvbXBvbmVudCA8SFRNTERpdkVsZW1lbnQsIEhUTUxGb3JtRWxlbWVudD4ge1xuICBcbiAgdGl0bGVJbnB1dEVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnRcbiAgZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnRcbiAgcGVvcGxlSW5wdXRFbGVtZW50OiBIVE1MSW5wdXRFbGVtZW50XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoJ3Byb2plY3QtaW5wdXQnLCAnYXBwJywgdHJ1ZSwgJ3VzZXItaW5wdXQnKVxuICAgIHRoaXMudGl0bGVJbnB1dEVsZW1lbnQgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignI3RpdGxlJykgYXMgSFRNTElucHV0RWxlbWVudFxuICAgIHRoaXMuZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignI2Rlc2NyaXB0aW9uJykgYXMgSFRNTElucHV0RWxlbWVudFxuICAgIHRoaXMucGVvcGxlSW5wdXRFbGVtZW50ID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwZW9wbGUnKSBhcyBIVE1MSW5wdXRFbGVtZW50XG4gICAgdGhpcy5jb25maWd1cmUoKVxuICB9XG5cbiAgY29uZmlndXJlKCkge1xuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCB0aGlzLmhhbmRsZVN1Ym1pdClcbiAgfVxuXG4gIHJlbmRlckNvbnRlbnQoKSB7XG4gICAgXG4gIH1cblxuICBwcml2YXRlIGdhdGhlclVzZXJJbnB1dHMoKTogW3N0cmluZywgc3RyaW5nLCBudW1iZXJdIHwgdm9pZCB7XG4gICAgY29uc3QgdGl0bGUgPSB0aGlzLnRpdGxlSW5wdXRFbGVtZW50LnZhbHVlXG4gICAgY29uc3QgZGVzY3JpcHRpb24gPSB0aGlzLmRlc2NyaXB0aW9uSW5wdXRFbGVtZW50LnZhbHVlXG4gICAgY29uc3QgcGVvcGxlID0gdGhpcy5wZW9wbGVJbnB1dEVsZW1lbnQudmFsdWVcblxuICAgIGNvbnN0IHZhbGlkYXRhYmxlVGl0bGVJbnB1dDogVmFsaWRhdGlvbi52YWxpZGF0YWJsZSA9IHtcbiAgICAgIHZhbHVlOiB0aXRsZSxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgbWluTGVuZ3RoOiA1LFxuICAgICAgbWF4TGVuZ3RoOiAxMFxuICAgIH1cbiAgICBjb25zdCB2YWxpZGF0YWJsZURlc2NyaXB0aW9uSW5wdXQ6IFZhbGlkYXRpb24udmFsaWRhdGFibGUgPSB7XG4gICAgICB2YWx1ZTogZGVzY3JpcHRpb24sXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgIG1pbkxlbmd0aDogNSxcbiAgICAgIG1heExlbmd0aDogMTVcbiAgICB9XG4gICAgY29uc3QgdmFsaWRhdGFibGVQZW9wbGVJbnB1dDogVmFsaWRhdGlvbi52YWxpZGF0YWJsZSA9IHtcbiAgICAgIHZhbHVlOiArcGVvcGxlLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICBtaW46IDEsXG4gICAgICBtYXg6IDVcbiAgICB9XG5cbiAgICBpZiAoIVZhbGlkYXRpb24udmFsaWRhdGUodmFsaWRhdGFibGVUaXRsZUlucHV0KSB8fCAhVmFsaWRhdGlvbi52YWxpZGF0ZSh2YWxpZGF0YWJsZURlc2NyaXB0aW9uSW5wdXQpIHx8ICFWYWxpZGF0aW9uLnZhbGlkYXRlKHZhbGlkYXRhYmxlUGVvcGxlSW5wdXQpKSB7XG4gICAgICBhbGVydCgnSW52YWxpZCBpbnB1dCcpXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBbdGl0bGUsIGRlc2NyaXB0aW9uLCArcGVvcGxlXVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgY2xlYXJJbnB1dHMoKSB7XG4gICAgdGhpcy50aXRsZUlucHV0RWxlbWVudC52YWx1ZSA9ICcnXG4gICAgdGhpcy5kZXNjcmlwdGlvbklucHV0RWxlbWVudC52YWx1ZSA9ICcnXG4gICAgdGhpcy5wZW9wbGVJbnB1dEVsZW1lbnQudmFsdWUgPSAnJ1xuICB9XG5cbiAgQGF1dG9iaW5kXG4gIHByaXZhdGUgaGFuZGxlU3VibWl0KGU6IEV2ZW50KSB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpXG4gICAgY29uc3QgdXNlcklucHV0cyA9IHRoaXMuZ2F0aGVyVXNlcklucHV0cygpXG4gICAgaWYgKEFycmF5LmlzQXJyYXkodXNlcklucHV0cykpIHtcbiAgICAgIGNvbnN0IFt0aXRsZSwgZGVzY3JpcHRpb24sIHBlb3BsZV0gPSB1c2VySW5wdXRzXG4gICAgICBwcm9qZWN0U3RhdGUuYWRkUHJvamVjdCh0aXRsZSwgZGVzY3JpcHRpb24sIHBlb3BsZSlcbiAgICAgIHRoaXMuY2xlYXJJbnB1dHMoKVxuICAgIH1cbiAgfVxufSIsImltcG9ydCB7UHJvamVjdExpc3R9IGZyb20gJy4vY29tcG9uZW50cy9wcm9qZWN0LWxpc3QnXG5pbXBvcnQge1Byb2plY3RJbnB1dH0gZnJvbSAnLi9jb21wb25lbnRzL3Byb2plY3QtaW5wdXQnXG5cbm5ldyBQcm9qZWN0SW5wdXQoKVxubmV3IFByb2plY3RMaXN0KCdhY3RpdmUnKVxubmV3IFByb2plY3RMaXN0KCdmaW5pc2hlZCcpXG5cbmNvbnNvbGUubG9nKCdIZWxsbyB0aGVyZScpIl0sInNvdXJjZVJvb3QiOiIifQ==